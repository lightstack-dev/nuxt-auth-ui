---
title: Route Protection Middleware
description: Configure automatic route protection and authentication redirects
---

The module provides route protection middleware that automatically redirects unauthenticated users and prevents access to protected content.

**By default, all routes are protected** -- except [configured auth routes](/docs/configuration#routes) which have special bidirectional behavior.

## Configuration

### Protect All Routes (Default)

By default, all routes are protected. No configuration needed:

```typescript [nuxt.config.ts]
export default defineNuxtConfig({
  modules: ['@lightstack-dev/nuxt-auth-ui']
  // All routes protected except auth routes
})
```

### Protect All Routes with Exceptions

```typescript [nuxt.config.ts]
export default defineNuxtConfig({
  authUi: {
    middleware: {
      protectByDefault: true,    // Default - protect everything
      exceptionRoutes: ['/', '/about', '/docs/*']  // Keep these public
    }
  }
})
```

### Protect Specific Routes Only

```typescript [nuxt.config.ts]
export default defineNuxtConfig({
  authUi: {
    middleware: {
      protectByDefault: false,    // Keep everything public by default
      exceptionRoutes: ['/dashboard', '/admin/*']  // Only protect these
    }
  }
})
```

### Disable Completely

```typescript [nuxt.config.ts]
export default defineNuxtConfig({
  authUi: {
    middleware: false
  }
})
```

## Options

| Option            | Type       | Default | Description                                               |
| ----------------- | ---------- | ------- | --------------------------------------------------------- |
| `middleware`      | `{ protectByDefault?: boolean, exceptionRoutes?: string[] } \| false`{lang="ts-type"}  | `{ protectByDefault: true }`{lang="ts"} | Set to `false`{lang="ts"} to disable middleware completely |
| `middleware.protectByDefault` | `boolean`{lang="ts-type"}  | `true`{lang="ts"}  | `true`{lang="ts"}: Protect all except exceptions<br>`false`{lang="ts"}: Protect only exceptions |
| `middleware.exceptionRoutes` | `string[]`{lang="ts-type"} | `[]`{lang="ts"}    | Routes that are exceptions to the protectByDefault setting |

## Route Patterns

```typescript
exceptionRoutes: [
  '/dashboard',      // Exact path
  '/admin/*',        // Wildcard matching
  '/api/user/*'      // API routes
]
```

## Behavior

**Auth routes** have special bidirectional behavior:
- **Unauthenticated users** can access auth routes (sign-in, sign-up, password-reset)
- **Authenticated users** accessing auth routes → Redirected away

**Protected routes**:
- **Unauthenticated users** accessing protected routes → Redirected to sign-in with return URL

Example flow:
```
/dashboard → /auth/sign-in?redirect=%2Fdashboard → /dashboard
```